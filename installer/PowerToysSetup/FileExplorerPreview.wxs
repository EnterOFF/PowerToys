<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi"
     xmlns:util="http://schemas.microsoft.com/wix/UtilExtension" >

  <?include $(sys.CURRENTDIR)\Common.wxi?>

  <?define PowerPreviewFiles=?>
  <?define PowerPreviewFilesPath=$(var.BinDir)modules\FileExplorerPreview\?>

  <Fragment>
    <DirectoryRef Id="FileExplorerPreviewInstallFolder" FileSource="$(var.RepoDir)\modules\FileExplorerPreview\">
    <!-- Generated by generateFileComponents.ps1 -->
    <!--PowerPreviewFiles_Component_Def-->
    </DirectoryRef>

    <DirectoryRef Id="MonacoPreviewHandlerMonacoCustomLanguagesFolder" FileSource="$(var.BinDir)modules\FileExplorerPreview\customLanguages">
      <Component Id="MonacoPreviewHandlerMonacoCustomLanguagesRegJS" Win64="yes">
        <File Id="MonacoPreviewHandler_MonacoCustomLanguagesRegJS" Source="$(var.BinDir)modules\FileExplorerPreview\customLanguages\reg.js" />
      </Component>
    </DirectoryRef>

    <ComponentGroup Id="FileExplorerPreviewComponentGroup" Directory="INSTALLFOLDER">
      <?foreach File in $(var.PowerPreviewFiles)?>
        <ComponentRef Id="PowerPreviewFiles_Comp_$(var.File)" />
      <?endforeach?>
      <ComponentRef Id="MonacoPreviewHandlerMonacoCustomLanguagesRegJS" />
    </ComponentGroup>
  </Fragment>
</Wix>
