<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi"
     xmlns:util="http://schemas.microsoft.com/wix/UtilExtension" >

  <?include $(sys.CURRENTDIR)\Common.wxi?>

  <?define FileLocksmithFiles=?>
  <?define FileLocksmithFilesPath=$(var.BinDir)modules\$(var.FileLocksmithProjectName)\?>

  <Fragment>
    <DirectoryRef Id="FileLocksmithInstallFolder" FileSource="$(var.BinDir)modules\$(var.FileLocksmithProjectName)">
    <!-- Generated by generateFileComponents.ps1 -->
    <!--FileLocksmithFiles_Component_Def-->
      <!-- !Warning! Make sure to change Component Guid if you update something here -->
      <Component Id="Module_FileLocksmith" Guid="108D3EC1-E6E0-4E81-88EF-25966133CB41" Win64="yes">
        <RegistryKey Root="HKCU" Key="Software\Classes\CLSID\{84D68575-E186-46AD-B0CB-BAEB45EE29C0}">
          <RegistryValue Type="string" Value="File Locksmith Shell Extension" />
          <RegistryValue Type="string" Name="ContextMenuOptIn" Value="" />
          <RegistryValue Type="string" Key="InprocServer32" Value="[FileLocksmithInstallFolder]PowerToys.FileLocksmithExt.dll" />
          <RegistryValue Type="string" Key="InprocServer32" Name="ThreadingModel" Value="Apartment" />
        </RegistryKey>
        <RegistryKey Root="HKCU" Key="Software\Classes\AllFileSystemObjects\ShellEx\ContextMenuHandlers\FileLocksmithExt">
          <RegistryValue Type="string" Value="{84D68575-E186-46AD-B0CB-BAEB45EE29C0}"/>
        </RegistryKey>
        <RegistryKey Root="HKCU" Key="Software\Classes\Drive\ShellEx\ContextMenuHandlers\FileLocksmithExt">
          <RegistryValue Type="string" Value="{84D68575-E186-46AD-B0CB-BAEB45EE29C0}"/>
        </RegistryKey>
        </Component>
    </DirectoryRef>
    <DirectoryRef Id="FileLocksmithAssetsInstallFolder" FileSource="$(var.BinDir)modules\$(var.FileLocksmithProjectName)\Assets">
      <Component Id="FileLocksmith_Assets_Icon" Win64="yes">
        <File Id="FileLocksmithAssetsFile_Icon" Source="$(var.BinDir)modules\$(var.FileLocksmithProjectName)\Assets\Icon.ico" />
      </Component>
      <Component Id="FileLocksmith_Assets_Applist_Scale100" Win64="yes">
        <File Id="FL_AppList_Scale100" Source="$(var.BinDir)modules\$(var.FileLocksmithProjectName)\Assets\AppList.scale-100.png" />
      </Component>
      <Component Id="FileLocksmith_Assets_Applist_Scale125" Win64="yes">
        <File Id="FL_AppList_Scale125" Source="$(var.BinDir)modules\$(var.FileLocksmithProjectName)\Assets\AppList.scale-125.png" />
      </Component>
      <Component Id="FileLocksmith_Assets_Applist_Scale150" Win64="yes">
        <File Id="FL_AppList_Scale150" Source="$(var.BinDir)modules\$(var.FileLocksmithProjectName)\Assets\AppList.scale-150.png" />
      </Component>
      <Component Id="FileLocksmith_Assets_Applist_Scale200" Win64="yes">
        <File Id="FL_AppList_Scale200" Source="$(var.BinDir)modules\$(var.FileLocksmithProjectName)\Assets\AppList.scale-200.png" />
      </Component>
      <Component Id="FileLocksmith_Assets_Applist_Scale400" Win64="yes">
        <File Id="FL_AppList_Scale400" Source="$(var.BinDir)modules\$(var.FileLocksmithProjectName)\Assets\AppList.scale-400.png" />
      </Component>
    </DirectoryRef>

    <ComponentGroup Id="FileLocksmithComponentGroup" Directory="INSTALLFOLDER">
      <ComponentRef Id="Module_FileLocksmith" />
      <?foreach File in $(var.FileLocksmithFiles)?>
        <ComponentRef Id="FileLocksmithFiles_Comp_$(var.File)" />
      <?endforeach?>
      <ComponentRef Id="FileLocksmith_Assets_Icon" />
      <ComponentRef Id="FileLocksmith_Assets_Applist_Scale100" />
      <ComponentRef Id="FileLocksmith_Assets_Applist_Scale125" />
      <ComponentRef Id="FileLocksmith_Assets_Applist_Scale150" />
      <ComponentRef Id="FileLocksmith_Assets_Applist_Scale200" />
      <ComponentRef Id="FileLocksmith_Assets_Applist_Scale400" />

    </ComponentGroup>

  </Fragment>
</Wix>
