<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi"
     xmlns:util="http://schemas.microsoft.com/wix/UtilExtension" >

  <?include $(sys.CURRENTDIR)\Common.wxi?>

  <?define PowerRenameFiles=?>
  <?define PowerRenameFilesPath=$(var.BinDir)modules\$(var.PowerRenameProjectName)\?>

  <Fragment>
    <DirectoryRef Id="PowerRenameInstallFolder" FileSource="$(var.BinDir)modules\$(var.PowerRenameProjectName)">
    <!-- Generated by generateFileComponents.ps1 -->
    <!--PowerRenameFiles_Component_Def-->
      <!-- !Warning! Make sure to change Component Guid if you update something here -->
      <Component Id="Module_PowerRename" Guid="40D43079-240E-402D-8CE8-571BFFA71175" Win64="yes">
        <RegistryKey Root="HKCU" Key="Software\Classes\CLSID\{0440049F-D1DC-4E46-B27B-98393D79486B}">
          <RegistryValue Type="string" Value="PowerRename Shell Extension" />
          <RegistryValue Type="string" Name="ContextMenuOptIn" Value="" />
          <RegistryValue Type="string" Key="InprocServer32" Value="[PowerRenameInstallFolder]PowerToys.PowerRenameExt.dll" />
          <RegistryValue Type="string" Key="InprocServer32" Name="ThreadingModel" Value="Apartment" />
        </RegistryKey>
        <RegistryKey Root="HKCU" Key="SOFTWARE\Classes\AllFileSystemObjects\ShellEx\ContextMenuHandlers\PowerRenameExt">
          <RegistryValue Type="string" Value="{0440049F-D1DC-4E46-B27B-98393D79486B}"/>
        </RegistryKey>

      </Component>
    </DirectoryRef>

    <DirectoryRef Id="PowerRenameMicrosoftUIXamlAssetsInstallFolder" FileSource="$(var.BinDir)modules\$(var.PowerRenameProjectName)\Microsoft.UI.Xaml\Assets">
      <Component Id="PowerRenameMicrosoftUIXamlAssets_NoiseAsset_256x256_PNG.png" Win64="yes">
        <File Id="PowerRenameMicrosoftUIXamlAssetsFile_NoiseAsset_256x256_PNG.png" Source="$(var.BinDir)modules\$(var.PowerRenameProjectName)\Microsoft.UI.Xaml\Assets\NoiseAsset_256x256_PNG.png" />
      </Component>
    </DirectoryRef>

    <DirectoryRef Id="PowerRenameAssetsFolder" FileSource="$(var.BinDir)modules\$(var.PowerRenameProjectName)">
      <!-- !Warning! Make sure to change Component Guid if you update the file list -->
      <Component Id="Module_PowerRename_Assets" Guid="BA290033-7861-44B7-8A04-7E4C3CC7F0AE" Win64="yes">
        <File Source="$(var.BinDir)modules\$(var.PowerRenameProjectName)\Assets\file.png" />
        <File Source="$(var.BinDir)modules\$(var.PowerRenameProjectName)\Assets\folder.png" />
      </Component>

      <Component Id="PowerRenameSparsePackageAssets_LargeTile.png" Win64="yes">
        <File Id="PowerRenameSparsePackageAssetsFile_LargeTile.png" Source="$(var.BinDir)modules\$(var.PowerRenameProjectName)\Assets\LargeTile.png" />
      </Component>
      <Component Id="PowerRenameSparsePackageAssets_SmallTile.png" Win64="yes">
        <File Id="PowerRenameSparsePackageAssetsFile_SmallTile.png" Source="$(var.BinDir)modules\$(var.PowerRenameProjectName)\Assets\SmallTile.png" />
      </Component>
      <Component Id="PowerRenameSparsePackageAssets_SplashScreen.png" Win64="yes">
        <File Id="PowerRenameSparsePackageAssetsFile_SplashScreen.png" Source="$(var.BinDir)modules\$(var.PowerRenameProjectName)\Assets\SplashScreen.png" />
      </Component>
      <Component Id="PowerRenameSparsePackageAssets_Square150x150Logo.png" Win64="yes">
        <File Id="PowerRenameSparsePackageAssetsFile_Square150x150Logo.png" Source="$(var.BinDir)modules\$(var.PowerRenameProjectName)\Assets\Square150x150Logo.png" />
      </Component>
      <Component Id="PowerRenameSparsePackageAssets_Square44x44Logo.png" Win64="yes">
        <File Id="PowerRenameSparsePackageAssetsFile_Square44x44Logo.png" Source="$(var.BinDir)modules\$(var.PowerRenameProjectName)\Assets\Square44x44Logo.png" />
      </Component>
      <Component Id="PowerRenameSparsePackageAssets_storelogo.png" Win64="yes">
        <File Id="PowerRenameSparsePackageAssetsFile_storelogo.png" Source="$(var.BinDir)modules\$(var.PowerRenameProjectName)\Assets\storelogo.png" />
      </Component>
      <Component Id="PowerRenameSparsePackageAssets_Wide310x150Logo.png" Win64="yes">
        <File Id="PowerRenameSparsePackageAssetsFile_Wide310x150Logo.png" Source="$(var.BinDir)modules\$(var.PowerRenameProjectName)\Assets\Wide310x150Logo.png" />
      </Component>
    </DirectoryRef>

    <ComponentGroup Id="PowerRenameComponentGroup" Directory="INSTALLFOLDER">
      <ComponentRef Id="Module_PowerRename" />
      <?foreach File in $(var.PowerRenameFiles)?>
        <ComponentRef Id="PowerRenameFiles_Comp_$(var.File)" />
      <?endforeach?>
	    <ComponentRef Id="PowerRenameMicrosoftUIXamlAssets_NoiseAsset_256x256_PNG.png" />
      <ComponentRef Id="Module_PowerRename_Assets" />
      <ComponentRef Id="PowerRenameSparsePackageAssets_LargeTile.png" />
      <ComponentRef Id="PowerRenameSparsePackageAssets_SmallTile.png" />
      <ComponentRef Id="PowerRenameSparsePackageAssets_SplashScreen.png" />
      <ComponentRef Id="PowerRenameSparsePackageAssets_Square150x150Logo.png" />
      <ComponentRef Id="PowerRenameSparsePackageAssets_Square44x44Logo.png" />
      <ComponentRef Id="PowerRenameSparsePackageAssets_storelogo.png" />
      <ComponentRef Id="PowerRenameSparsePackageAssets_Wide310x150Logo.png" />

    </ComponentGroup>

  </Fragment>
</Wix>
